{% extends "layout.html" %}

{% block css %}
    <link rel="stylesheet" href="{{ url_for('chat.static', filename='css/chat.css') }}">
    <link rel="stylesheet" href="{{ url_for('chat.static', filename='css/poi.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
{% endblock %}

{% block content %}
    <button id="showSidebar" style="display:none; position:fixed; left:0; top:50%; background:var(--brand); color:white; border:none; padding:10px; border-radius:0 8px 8px 0; cursor:pointer; transform:translateY(-50%);">Show</button>


    <div class="app">
        <!-- HISTORY SIDEBAR -->
        <aside class="sidebar" aria-label="Conversations">
        <div class="top">
            <div class="sidebar-header">    
                <h3><i class="fas fa-history"></i> History</h3>
                <div class="controls">
                    <button id="btnNew" title="New chat" class="control-btn new-btn"><i class="fas fa-plus"></i></button>
                    <button id="btnDeleteSelected" title="Delete Selected Conversation" class="control-btn delete-btn"><i class="fas fa-trash"></i></button>
                    <button id="hideBtn" title="Hide sidebar" class="control-btn hide-btn"><i class="fas fa-chevron-left"></i></button>
                </div>
            </div>
        </div>

        <div class="search">
            <i class="fas fa-search search-icon"></i>
            <input id="searchInput" placeholder="Search conversations..." />
        </div>

        <div id="convoList" class="convo-list" role="list">
            <!-- conversations injected here -->
        </div>
        </aside>

        <!-- CHAT PANEL -->
        <section class="chat">
        <div class="card">
            <div class="chat-header">
            <div class="header-content">
                <strong id="convTitle" class="chat-title">Chưa chọn đoạn chat</strong>
                <div class="chat-subtitle"><i class="fas fa-circle-info"></i> Type issues like "lost visa"</div>
            </div>
            <div class="header-actions">
                <button id="btnAttach" class="btn btn-attach" title="Attach file"><i class="fas fa-paperclip"></i></button>
            </div>
            </div>

            <div id="chatMessages" class="chat-messages" aria-live="polite">
            <!-- messages appended here -->

            </div>

            <div class="chat-input-wrapper">
                <div class="chat-input">
                    <input id="chatInput" placeholder="Describe your problem, e.g. 'I lost my visa'..." aria-label="message input" />
                    <button id="sendBtn" class="send-btn" title="Send message"><i class="fas fa-paper-plane"></i></button>
                </div>
            </div>
        </div>
        </section>

        <!-- MAP -->
        <aside>
          <div id="map">
            <div class="transport-btns">
                <button data-travel="driving" class="active">Driving</button>
                <button data-travel="Motorcycling"> Motorcycling</button>
                <button data-travel="walking"> Walking</button>
            </div>
          </div>
        </aside>
    </div>
{% endblock %}



{% block script %}
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
    <script type = "module" src="{{ url_for('chat.static', filename='scripts/logic.js') }}"> </script>
{% endblock %}
